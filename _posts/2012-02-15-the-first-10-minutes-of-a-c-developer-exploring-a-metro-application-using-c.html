---
layout: post
title: The first 10 Minutes of a C# Developer Exploring a Metro Application using Visual C++
excerpt: 
tags: 
comments: true
---

<h3><a href="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_7.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_thumb_7.png" width="236" height="246" /></a></h3>  <p>&#160;</p>  <h3>Introduction</h3>  <p>I’m a C# guy through and through but I have recently been exploring Visual C++ . I decided to take you with me as I spend 10 minutes exploring the Visual C++ Metro Templates included with Visual Studio 11. This blog post is written with my background in C#. I will try to point out the differences as I see them. We will look at Visual C++ templates solution explorer some XAML and even some code-behind. </p>  <p>Let’s get started with templates. </p>  <h3>The Visual C++/C# Metro Templates built-into VS 11</h3>  <p>Visual Studio 11 has the following templates built-into it for Visual C++/C# projects: </p>  <p><a href="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_8.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_thumb_8.png" width="709" height="433" /></a></p>  <p><a href="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_9.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_thumb_9.png" width="710" height="402" /></a></p>  <p>The description of each project type is located below: </p>  <ul>   <li>Application – A blank project using the Metro style framework.&#160;&#160; </li>    <li>Grid Application – A multi-page project for navigating multiple layers of content with item details displayed on a dedicated page. </li>    <li>Split Application – A project for navigating among a master list of items while viewing their details on the same page. </li>    <li>Unit Test Project – A Unit Test Project. </li>    <li>WinRT Component DLL – Template for a Windows Metro Style server DLL. </li>    <li><strong>DirectX Application – (Only in C++) Template for a blank Windows Metro style application using DirectX</strong>. </li> </ul>  <p>The only thing to note here is the inclusion of a DirectX Application with the C++ Templates. Everything else is pretty much identical in terms of the template structure. </p>  <h3>The Solution Explorer</h3>  <p>If you take a look at the<strong> “Application Template”</strong> for C++&#160; vs. C# then you will notice some differences. </p>  <p><a href="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_10.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_thumb_10.png" width="267" height="409" /></a><a href="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image23_3.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image23_thumb_3.png" width="283" height="403" /></a></p>  <h3>Looking at the C++ Solution Explorer in depth</h3>  <ol>   <li>If you expand <strong>“External Dependencies”</strong> then you will see a long list of header files along with other files needed to build a C++ Metro application. This is necessary for the application to compile as we also have standard references needed to use certain libraries in a C# application. </li>    <li>The <strong>Resources</strong> Folder contains 4 PNG images that we are used to seeing inside of the <strong>Images</strong> folder in a C# Application. </li>    <li>The only difference in the <strong>App.xaml</strong> and <strong>MainPage.xaml</strong> is that in the C++ application it contains both a .cpp (C ++) and .h (header) file whereas the C# version only contains the .cs (C Sharp) file. </li>    <li>The <strong>Package.appxmanifest</strong> exist in both projects and contains metadata that describes your app including display name description logos and capabilities. </li>    <li>Finally we get to the <strong>pch.cpp/pch.h</strong> files which are pre-compiled header files and are obviously not included in the C# application. </li> </ol>  <p>The other thing you might notice is that the C# application contains an <strong>AssemblyInfo.cs</strong> under <strong>Properties</strong> whereas the C++ version did not. This file consists of all of the build options for the project including version company name GUID compilers options etc.     <br /></p>  <h3>Looking at a simple “Hello World” Application – The XAML</h3>  <p>A button and a TextBlock… it doesn’t get any easier than this. If the user clicks the button then it displays “Hello World” in a TextBlock as shown below. </p>  <p><a href="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_11.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/The-first-10-minutes-with-a-Metro-Applic_126E8/image_thumb_11.png" width="250" height="121" /></a></p>  <p>Thankfully XAML is XAML – the following code snippet works regardless if you are using C# VB or C++.</p>  <pre class="brush: xml;">&lt;Grid x:Name=&quot;LayoutRoot&quot; Background=&quot;#FF0C0C0C&quot;&gt;                &lt;StackPanel&gt;      &lt;Button Content=&quot;Click Me&quot; FontSize=&quot;24&quot; Width=&quot;200&quot; Height=&quot;60&quot; Click=&quot;HelloButton_Click&quot; /&gt;      &lt;TextBlock x:Name=&quot;DisplayText&quot; FontSize=&quot;48&quot; Foreground=&quot;White&quot; /&gt;       &lt;/StackPanel&gt;  &lt;/Grid&gt;    </pre>    <h3>The Code Behind</h3>    <p>You knew this part would be massively different didn’t you? I hope so – we are talking about an entirely different language. :)</p>    <p>Below is a “Hello World” that works with the XAML included above in C#: </p>    <pre class="brush: csharp;">private void HelloButton_Click(object sender RoutedEventArgs e)  {      DisplayText.Text = &quot;Hello World&quot;;  }</pre>    <p>That same “Hello World” looks like the following in C++</p>    <pre class="brush: cpp;">void HelloWorld::MainPage::HelloButton_Click(Platform::Object^ sender Windows::UI::Xaml::RoutedEventArgs^ e)  {      DisplayText-&gt;Text = &quot;Hello World&quot;;    }</pre>    <p>Look at the way the event handler is setup. Looks foreign right now doesn’t it? No worries give this free <a href="http://www.bobtacoindustries.com/Content/Devs/CsToCpp-ASomewhatShortGuide.pdf">e-Book</a> a spin to convert your existing C# skills to C++. </p>    <h3>Wrap-up</h3>    <p>What did we learn in 10 minutes? We learned about several differences in C# and Visual C++ Metro Applications. But the real challenge here isn’t learning the new templates differences in solution explorer or XAML. It is that we need to learn the language. I’m not going to go into why I’m spending nights/weekends dabbling in Visual C++ bu
