---
layout: post
title: Communicating between two local Silverlight Applications
excerpt: 
tags: 
comments: true
---

<p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/image_6.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/image_thumb_2.png" width="582" height="424" /></a></p>  <p><strong></strong></p>  <p><strong>Introduction</strong></p>  <p>One of the features that I’m surprised to see hardly no one talk about is “<em>Communication Between Local Silverlight-Based Applications</em>”. This is not new to Silverlight as it has been around since Silverlight 3. In other words this will allow you to have two Silverlight applications running on the same PC talk to one another without using Web Services etc. I originally was looking into this for a pet project that I was going to use with Kinect but found this very valuable and decided to share with everyone.&#160; </p>  <p><strong>Getting Started</strong></p>  <p>We are going to create two separate Silverlight Applications (select Silverlight 4 or 5 Beta). The First application that we are going to create is the receiver. </p>  <p><strong>Creating the Receiver</strong></p>  <p>Launch Visual Studio 2010 and create a new Silverlight Application and name it “SilverlightReceiver”.</p>  <p>In your MainPage.xaml </p>  <pre class="brush: xml;">&lt;Grid x:Name=&quot;LayoutRoot&quot; Background=&quot;Yellow&quot;&gt;      &lt;TextBlock HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Center&quot; TextWrapping=&quot;Wrap&quot; Text=&quot;...Waiting for Message!&quot; x:Name=&quot;txtReceiver&quot;/&gt;  &lt;/Grid&gt;</pre>    <p>In your MainPage.xaml.cs</p>    <pre class="brush: csharp;">using System;  using System.Windows;  using System.Windows.Controls;  using System.Windows.Messaging;    namespace SilverlightReceiver  {      public partial class MainPage : UserControl      {          public MainPage()          {              InitializeComponent();              Loaded += MainPage_Loaded;          }            void MainPage_Loaded(object sender RoutedEventArgs e)          {              var messageReceiver = new LocalMessageReceiver(&quot;receiver&quot; ReceiverNameScope.Global LocalMessageReceiver.AnyDomain);              messageReceiver.MessageReceived += receiver_MessageReceived;                            try              {                  messageReceiver.Listen();              }              catch (ListenFailedException)              {                  MessageBox.Show(                      &quot;Cannot receive messages.&quot; + Environment.NewLine +                      &quot;There is already a receiver with the name 'receiver'.&quot;                      &quot;LocalMessageReceiver&quot; MessageBoxButton.OK);              }          }            private void receiver_MessageReceived(object sender MessageReceivedEventArgs e)          {              txtReceiver.Text = e.Message;              e.Response = &quot;Message received&quot;;          }      }  }</pre>    <p>Your MainPage.xaml for your Receiver should look like this in design mode: </p>    <p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/image_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/image_thumb.png" width="440" height="330" /></a></p>    <p><strong>Creating the Sender</strong></p>    <p>Launch Visual Studio 2010 and create a new Silverlight Application and name it “SilverlightSender”.</p>    <p>In your MainPage.xaml </p>    <pre class="brush: xml;">&lt;Grid x:Name=&quot;LayoutRoot&quot;&gt;      &lt;Button Content=&quot;Send a Message&quot; Click=&quot;SendClick&quot; Margin=&quot;10&quot;/&gt;        &lt;/Grid&gt;</pre>    <p>In your MainPage.xaml.cs</p>    <pre class="brush: csharp;">using System.Windows;  using System.Windows.Controls;  using System.Windows.Messaging;    namespace SilverlightSender  {      public partial class MainPage : UserControl      {          private LocalMessageSender _messageSender = new LocalMessageSender(&quot;receiver&quot;);            public MainPage()            {                InitializeComponent();                Loaded += MainPage_Loaded;            }            void MainPage_Loaded(object sender RoutedEventArgs e)          {              _messageSender = new LocalMessageSender(&quot;receiver&quot;LocalMessageSender.Global);              _messageSender.SendCompleted += _sender_SendCompleted;          }                void _sender_SendCompleted(object sender SendCompletedEventArgs e)            {                MessageBox.Show(&quot;Response \&quot;&quot; + e.Response + &quot;\&quot; receieved.&quot; &quot;LocalMessageSender&quot; MessageBoxButton.OK);            }                private void SendClick(object sender RoutedEventArgs e)          {              _messageSender.SendAsync(&quot;Don't you love michaelcrump.net?&quot;);           }      }  }</pre>  Your MainPage.xaml for your Receiver should look like this in design mode:     <p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/image_4.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/image_thumb_1.png" width="403" height="300" /></a></p>    <p><strong>Time to run it!</strong></p>    <p>Launch the receiver application first…</p>    <p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d62506.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML4d62506" border="0" alt="SNAGHTML4d62506" src="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d62506_thumb.png" width="531" height="373" /></a></p>    <p>Then the sender application second…</p>    <p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d6ee0f.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML4d6ee0f" border="0" alt="SNAGHTML4d6ee0f" src="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d6ee0f_thumb.png" width="529" height="372" /></a></p>    <p>Click the “Send a Message” button and you should instantly get:</p>    <p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d785cb.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML4d785cb" border="0" alt="SNAGHTML4d785cb" src="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d785cb_thumb.png" width="523" height="367" /></a></p>    <p>Now click on your receiver application…</p>    <p><a href="http://geekswithblogs.net/images/geekswithblogs_net/mbcrump/Windows-Live-Writer/b853e653c884_C34F/SNAGHTML4d84294.png"><img style="background-image: none; border-right-width: 0px; p
