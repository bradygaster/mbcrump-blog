---
layout: post
title: Get the Total Duration of WMV Files inside a Directory using C#
excerpt: 
tags: 
comments: true
---

<h4>Introduction</h4>  <p>Since becoming a <a href="http://pluralsight.com/training/Authors/Details/michael-crump">Pluralsight</a> author I’ve often needed to get the total duration of all the .wmv files inside of a directory. I would typically use an application that they provide but it requires you to load each Module one by one. I decided I’d write a quick and dirty application that would return the total duration using the WindowsMediaPlayer class. </p>  <h4>How to Use it</h4>  <p>Simply download the code off of <a href="https://github.com/mbcrump/wmvduration">Github</a> and add a reference to the file located at : “c:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\PrivateAssemblies\WMPLib.dll” (Using VS2013 – If you are using another version of Visual Studio then just search your system for the file called “WMPLib.dll”). Build the project or grab the <a href="http://michaelcrump.net/get/WMVDuration.zip">executable here</a> and run the following command inside the folder that WMVDuration.exe exist. (FYI: I built this with the .NET 4.5 Framework which is overkill but was the default.) </p>  <div id="codeSnippetWrapper" style="overflow: auto; cursor: text; font-size: 8pt; border-top: silver 1px solid; font-family: &#39;Courier New&#39; courier monospace; border-right: silver 1px solid; width: 97.5%; border-bottom: silver 1px solid; padding-bottom: 4px; direction: ltr; text-align: left; padding-top: 4px; padding-left: 4px; margin: 20px 0px 10px; border-left: silver 1px solid; line-height: 12pt; padding-right: 4px; max-height: 200px; background-color: #f4f4f4">   <div id="codeSnippet" style="border-top-style: none; overflow: visible; font-size: 8pt; font-family: &#39;Courier New&#39; courier monospace; width: 100%; border-bottom-style: none; color: black; padding-bottom: 0px; direction: ltr; text-align: left; padding-top: 0px; border-right-style: none; padding-left: 0px; border-left-style: none; line-height: 12pt; padding-right: 0px; background-color: #f4f4f4">     <pre style="border-top-style: none; overflow: visible; font-size: 8pt; font-family: &#39;Courier New&#39; courier monospace; width: 100%; border-bottom-style: none; color: black; padding-bottom: 0px; direction: ltr; text-align: left; padding-top: 0px; border-right-style: none; padding-left: 0px; margin: 0em; border-left-style: none; line-height: 12pt; padding-right: 0px; background-color: white">WMVDuration.exe C:\WMVDirectory\</pre>  <!--CRLF--></div>  </div>    <p>Below is an example of it running on my current course. </p>    <p><a href="http://michaelcrump.net/files/image_635260077512291826.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_635260077517752106.png" width="592" height="146" /></a></p>        <p><strong>Disclaimer</strong>: Keep in mind that this code has not been tested but works for my situation. It would be easy to modify this to support mp4 files for Mac rounding the milliseconds up etc.&#160; </p>    <h4>Wrap-Up</h4>    <p>Thanks again for reading and I hope you have a wonderful day! </p>
