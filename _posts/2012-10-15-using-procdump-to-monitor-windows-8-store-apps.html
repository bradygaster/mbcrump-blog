---
layout: post
title: Using ProcDump to Monitor Windows 8 Store Apps
excerpt: 
tags: 
comments: true
---

<h3>Introduction</h3>  <p>There may be some instances where you want to monitor Windows 8 Store Apps without installing Visual Studio 2012. Thankfully you can do this pretty easily by using ProcDump and ProcessMonitor. Here is a step-by-step guide on how to do so or if you prefer watch this <a href="http://channel9.msdn.com/Shows/Defrag-Tools/Defrag-Tools-11-ProcDump-Windows-8--Process-Monitor">video</a> which inspired me to write this post.</p>  <h3>Step 1:</h3>  <p><a href="http://technet.microsoft.com/en-us/sysinternals/dd996900.aspx">Download ProcDump 5.0</a> </p>  <p>As described by it’s author : “<em>ProcDump is a command-line utility whose primary purpose is monitoring an application for CPU spikes and generating crash dumps during a spike that an administrator or developer can use to determine the cause of the spike. ProcDump also includes hung window monitoring (using the same definition of a window hang that Windows and Task Manager use) unhandled exception monitoring and can generate dumps based on the values of system performance counters. It also can serve as a general process dump utility that you can embed in other scripts.”</em></p>  <p><a href="http://technet.microsoft.com/en-us/sysinternals/bb896645">Download Process Monitor v3.03</a></p>  <p>As described by it’s author : “<em>Process Monitor</em> is an advanced monitoring tool for Windows that shows real-time file system Registry and process/thread activity. It combines the features of two legacy Sysinternals utilities <em>Filemon</em> and <em>Regmon</em> and adds an extensive list of enhancements including rich and non-destructive filtering comprehensive event properties such session IDs and user names reliable process information full thread stacks with integrated symbol support for each operation simultaneous logging to a file and much more. Its uniquely powerful features will make Process Monitor a core utility in your system troubleshooting and malware hunting toolkit.”</p>  <h3>Step 2:</h3>  <p>Open the registry and browse to the following folder: HKEY_CURRENT_USER\Software\Classes\ActivatableClasses\Package. Once there navigate to the application you want to monitor. In this case we are going to monitor the built-in Camera Application. </p>  <p>Click on the Application Folder then Server and double-click AppUserModelID as shown below.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTMLad4c950_634858793213364268.png"><img title="SNAGHTMLad4c950" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLad4c950" src="http://michaelcrump.net/files/SNAGHTMLad4c950_thumb_634858793245968268.png" width="746" height="396" /></a></p>  <p>Copy and paste the string value highlighted below. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTMLad74a7c_634858793250024268.png"><img title="SNAGHTMLad74a7c" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLad74a7c" src="http://michaelcrump.net/files/SNAGHTMLad74a7c_thumb_634858793256420268.png" width="407" height="184" /></a></p>  <h3>Step 3:</h3>  <p>Navigate over to where you extracted the procdump and procmon tools and run the following command (exchange the camera part with whatever value your App.UserModelID is) </p>  <pre class="brush: plain;">procdump -e 1 -f &quot;&quot; -x c:\procdump Microsoft.Camera_8wekyb3d8bbwe!Microsoft.Camera</pre>    <p>Note: You can easily see what each switch does by just calling procdump from the command prompt. In this case we are using the following:&#160; <br />      <br />&#160;&#160; -e&#160;&#160;&#160; Write a dump when the process encounters an unhandled exception.       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Include the 1 to create dump on first chance exceptions.       <br />      <br />&#160;&#160; -f&#160;&#160;&#160; Filter the first chance exceptions. Wildcards (*) are supported.       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; To just display the names without dumping use a blank (&quot;&quot;) filter.       <br />      <br />&#160;&#160;&#160; -x&#160;&#160;&#160; Launch the specified image with optional arguments.       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If it is a Modern Application or Package ProcDump will start       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; on the next activation (only).</p>    <p>Your Windows Store App will launch. Switch back over to the <strong>Desktop mode</strong> and look in the Command Prompt as shown below. </p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLadc88e5_634858793261100268.png"><img title="SNAGHTMLadc88e5" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLadc88e5" src="http://michaelcrump.net/files/SNAGHTMLadc88e5_thumb_634858793271864268.png" width="601" height="243" /></a></p>    <p>With RegEdit still open hit F5 to refresh the screen and notice the new folder called “DebugInformation” with a key called “DebugPath”: </p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLafa8597_634858793318976268.png"><img title="SNAGHTMLafa8597" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLafa8597" src="http://michaelcrump.net/files/SNAGHTMLafa8597_thumb_634858793342688268.png" width="720" height="382" /></a></p>    <p>You will also see an additional window that provides info about the current file it is monitoring and includes any caught exceptions: </p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLadf10c8_634858793347836268.png"><img title="SNAGHTMLadf10c8" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLadf10c8" src="http://michaelcrump.net/files/SNAGHTMLadf10c8_thumb_634858793360160268.png" width="571" height="292" /></a></p>    <p>As stated you can hit Ctrl-C to quit monitoring the app without terminating the process. You are also free to monitor the dmp file created. </p>    <h3>Step 4 – Additional Info: </h3>    <p>While the application is running you can now open procmon.exe and filter by the process name or even better the process id to monitor the event properties. </p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLae07e14%5B4%5D_634858793371080268.png"><img title="SNAGHTMLae07e14[4]" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLae07e14[4]" src="http://michaelcrump.net/files/SNAGHTMLae07e14%5B4%5D_thumb_634858793403840268.png" width="660" height="357" /></a></p>    <p>You can double click on any event and see the event process and stack. </p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLae2a3c2_634858793411016268.png"><img title="SNAGHTMLae2a3c2" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SNAGHTMLae2a3c2" src="http://michaelcrump.net/files/SNAGHTMLae2a3c2_thumb_634858793428488268.png" width="454" height="520" /></a></p>    <h3>Wrap-up</h3>    <p>I have always been a fan of Sysinternal and I am very happy that procdump works wonderfully with Windows 8 Store Apps. If you have any questions then feel free to leave them below otherwise see you in the next post!
