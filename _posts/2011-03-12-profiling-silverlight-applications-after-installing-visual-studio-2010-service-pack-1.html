---
layout: post
title: Profiling Silverlight Applications after installing Visual Studio 2010 Service Pack 1
excerpt: 
tags: 
comments: true
---

<p><strong>Introduction</strong></p>  <p>Now that the dust has settled and everyone has downloaded and installed Visual Studio 2010 Service Pack 1 its time to talk about a new feature included that will help Silverlight Developers profile their applications. Let’s take a look at what the official documentation says about it: </p>  <p><b></b></p>  <p><strong>Performance Wizard for Silverlight – taken from </strong><a href="http://support.microsoft.com/kb/983509" target="_blank"><strong>VS2010 SP1</strong></a><strong> KB.</strong></p>  <p>Visual Studio 2010 SP1 enables you to tune the Silverlight application performance by profiling the code. A traditional code profiler cannot tune the rendering performance for Silverlight applications. Many higher-level profilers are added to Visual Studio 2010 SP1 so that you can better determine which parts of the application consume time.</p>  <p><strong>So how do you do it?</strong></p>  <p>After you finish installing VS2010 SP1 make sure it took by going to Help –&gt; About. You should see SP1Rel under Visual Studio 2010 as shown below. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML92dcca_634591062761137637.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML92dcca" border="0" alt="SNAGHTML92dcca" src="http://michaelcrump.net/files/SNAGHTML92dcca_thumb_634591062824630451.png" width="602" height="450" /></a></p>  <p>Now that we have verified you are on the most current release let’s load up a Silverlight Application. </p>  <p>I’m going to take my <a href="http://michaelcrump.info/" target="_blank">hobby Silverlight project</a> that I created a month or so ago. The reason that I’m picking this project is that I didn’t focus so much on performance as it was just built for fun and to see what I could do with Silverlight. I believe this makes the perfect application to profile.&#160; </p>  <p>After the project is loaded click on Analyze then Launch Performance Wizard. </p>  <p><a href="http://michaelcrump.net/files/image_634591062835862595.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591062859730901.png" width="594" height="378" /></a></p>  <p>Go ahead and click on CPU Sampling (recommended). </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML9aa22a_634591062869871031.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML9aa22a" border="0" alt="SNAGHTML9aa22a" src="http://michaelcrump.net/files/SNAGHTML9aa22a_thumb_634591062890151291.png" width="480" height="413" /></a></p>  <p>You will notice that it ask which application to target. By Default it will select the .Web project in an Silverlight Application. Go ahead and leave the default Web Project checked. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML9c5dfa_634591062899511411.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML9c5dfa" border="0" alt="SNAGHTML9c5dfa" src="http://michaelcrump.net/files/SNAGHTML9c5dfa_thumb_634591062916203625.png" width="481" height="413" /></a></p>  <p>We are going to leave the client as Internet Explorer. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML9eab10_634591062924003725.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML9eab10" border="0" alt="SNAGHTML9eab10" src="http://michaelcrump.net/files/SNAGHTML9eab10_thumb_634591062935079867.png" width="482" height="414" /></a></p>  <p>Now go ahead and click finish.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTML9f2f8b_634591062943659977.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML9f2f8b" border="0" alt="SNAGHTML9f2f8b" src="http://michaelcrump.net/files/SNAGHTML9f2f8b_thumb_634591062959884185.png" width="486" height="418" /></a></p>  <p>Now your Silverlight Application will launch. </p>  <p><a href="http://michaelcrump.net/files/image_634591063075481667.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591063140534501.png" width="741" height="397" /></a></p>  <p>While your application is running you will see the following inside of Visual Studio 2010. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTMLa14c2f_634591063144590553.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTMLa14c2f" border="0" alt="SNAGHTMLa14c2f" src="http://michaelcrump.net/files/SNAGHTMLa14c2f_thumb_634591063150830633.png" width="414" height="214" /></a></p>  <p>Here is where you will need to attach your Silverlight Application to the web application that is current being profiled. Simply click on the&#160; Attach/Detach button below and find your application to attach to the profiler. In my case I am using IE8 and could find it by the title. </p>  <p><a href="http://michaelcrump.net/files/image_634591063169706875.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591063206523347.png" width="699" height="488" /></a></p>  <p>After you close your browser you will notice it generated a report:</p>  <p>These files will end with a .VSP</p>  <p><a href="http://michaelcrump.net/files/image_634591063220251523.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591063262216061.png" width="637" height="365" /></a></p>  <p>If you click on the .VSP you will it generated the following report:</p>  <p><a href="http://michaelcrump.net/files/image_634591063272980199.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591063285928365.png" width="569" height="322" /></a></p>  <p>We could turn off “Just My Code” but it may pick up things that we didn’t want to profile as shown below:</p>  <p><a href="http://michaelcrump.net/files/image_634591063328048905.png"><img style="background-imag
