---
layout: post
title: Extracting a SQL CE DB from Isolated Storage in WP7 Mango.
excerpt: 
tags: 
comments: true
---

<p><strong>Introduction</strong></p>  <p>By now most of you have heard that Windows Phone 7 – Mango release will support Local Databases (SQL CE) using Linq to SQL. But what you probably haven’t heard much about is how to extract the .SDF that is created in isolated storage to your local computer and view the contents. I find this extremely important for debugging application and making sure my database is setup exactly like I want it. So that is what we are going to do today. </p>  <p><strong>Getting Started with a sample application:</strong></p>  <p><img title="Local Database Sample" alt="Local Database Sample" src="http://i.msdn.microsoft.com/dynimg/IC505306.png" /></p>  <p>For this tutorial we will need a sample application that uses a local database. If you are already using a local database (SQL CE) in your mango application then you can skip this section otherwise go ahead and download the “<a href="http://msdn.microsoft.com/en-us/library/ff431744%28v=VS.92%29.aspx">Local Database Sample</a>” from MSDN. </p>  <blockquote>   <p>Below is an excerpt from the MSDN Page</p> </blockquote>  <blockquote>   <p>On Windows Phone OS 7.1 you can use LINQ to SQL to store relational data in a local database that resides in your application’s isolated storage container. This sample is a to-do list application that uses a multi-table local database. Items that appear in the list are added updated and deleted from a local database where they will persist between application launches. For step-by-step information about how to develop this application see <a href="http://msdn.microsoft.com/en-us/library/hh286405(v=VS.92).aspx">How to: Create a Local Database Application with MVVM for Windows Phone</a>.</p>    <p>Download Sample: <a href="http://go.microsoft.com/fwlink/?LinkId=219066">C#</a> | <a href="http://go.microsoft.com/fwlink/?LinkId=223469">VB</a></p> </blockquote>  <p><strong>The Database Structure</strong></p>  <p>We see code that defines our database name in App.xaml.cs. It is simply called ToDo.sdf: </p>  <pre class="brush: csharp;">// Specify the local database connection string.  string DBConnectionString = &quot;Data Source=isostore:/ToDo.sdf&quot;;</pre>    <p>And code that creates a table and defines the columns</p>    <pre class="brush: csharp;">[Table]  public class ToDoItem  {      [Column( IsPrimaryKey = true )]      public int ToDoItemId { get; set; }         [Column]      public string ItemName { get; set; }         [Column]      public bool IsComplete { get; set; }         [Column]      public int _categoryId { get; set; }         [Column]      private Binary _version { get; set; }  }</pre>    <p><em>Please note that I removed all code relating to MVVM to simplify this example. If you wish to see the code then please review Model –&gt; ToDoDataContext.cs. This sample also has another Table called ToDoCategory that was not included in this tutorial.&#160; </em></p>    <p>Now that we have reviewed what the database looks like lets see what it takes to extract the .SDF file from isolated storage to our local pc. </p>    <p><strong>Get the required tools if you haven’t already. </strong></p>    <ol>    <li><a href="http://go.microsoft.com/?linkid=9772716">Download the Windows Phone SDK 7.1 RC</a> and install it if you already have not. </li>      <li><a href="http://silverlight.codeplex.com/">Grab the Silverlight Toolkit for Mango.</a> </li>      <li>Download the “<a href="http://msdn.microsoft.com/en-us/library/ff431744%28v=VS.92%29.aspx">Local Database Sample</a>” from MSDN if you want to use this example. </li>  </ol>    <p>Go ahead and run the application and enter some data. My screen looks like this: </p>    <p><a href="http://michaelcrump.net/files/image_634587868762769148.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587868771349313.png" width="279" height="463" /></a></p>    <p>This should be enough data for us to work with. </p>    <p>&#160;</p>    <p>Leave the emulator running and navigate to the Properties –&gt; WMAppManifest.xml file. Open up notepad and copy/paste the ProductId into it. </p>    <p><a href="http://michaelcrump.net/files/image16_634587868778213445.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image16_thumb_634587868798025826.png" width="848" height="218" /></a>&#160;</p>    <p>Go ahead and navigate over to your “C:\Program Files (x86)\Microsoft SDKs\Windows Phone\v7.1\Tools\IsolatedStorageExplorerTool” and run the following command:</p>    <p>ISETool.exe ts xd 888a966b-516e-4f9d-a6c3-343454e07466 &quot;C:\Users\MichaelCrump\Desktop\IsoStore&quot;</p>    <p>You should:</p>    <ul>    <li>Replace the GUID with your own. </li>      <li>Give it a proper file location to output the file. </li>  </ul>    <p>Here is what my command window looks like:</p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLcd2a9_634587868805981979.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTMLcd2a9" border="0" alt="SNAGHTMLcd2a9" src="http://michaelcrump.net/files/SNAGHTMLcd2a9_thumb_634587868822518297.png" width="697" height="244" /></a></p>    <p><em>Note: I kept getting this message that is was already being used but it actually built the file anyways. </em></p>    <p><em></em></p>    <p>Navigate over to the directory that you specified earlier and you will see your .SDF file from IsolatedStorage. Pretty cool huh? </p>    <p><a href="http://michaelcrump.net/files/SNAGHTMLf7cfc_634587868834686531.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTMLf7cfc" border="0" alt="SNAGHTMLf7cfc" src="http://michaelcrump.net/files/SNAGHTMLf7cfc_thumb_634587868857306966.png" width="690" height="400" /></a></p>    <p>&#160;</p>    <p>Go ahead and switch over to Server Explorer inside of Visual Studio 2010 and let’s add that SDF to the project. Right click on Data Connection then select “Add Connection”.</p>    <p>&#160;</p>    <p><a href="http://michaelcrump.net/files/image_634587868864951113.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587868878523374.png" width="415" height="192" /></a></p>    <p>&#160;</p>    <p>Make sure you select the Data Source to be: SQL Server Compact 3.5 and then hit Browser and select the .SDF file just created. </p>    <p><em>Please note that I could not get SQL Server Compact 4.0 Data Source to work with this sample. </em></p>    <p><a href="http://michaelcrump.net/files/SNAGHTML129bd1_634587868888507566.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML129bd1" border="0" alt="SNAGHTML129bd1" src="http://michaelcrump.net/files/SNAGHTML129bd1_thumb_634587868909411968.png" width="382" height="513" /></a></p>    <p>Hit OK and you should see your database that you crated in Mango (that was living in Isolated Storage) inside of Visu
