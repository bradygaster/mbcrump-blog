---
layout: post
title: Attaching a Command to the WP7 Application Bar.
excerpt: 
tags: 
comments: true
---

<p>One of the biggest problems that I’ve seen with people creating WP7 applications is how do you bind the application bar to a Relay Command. If your using MVVM then this is particular important. Let’s examine the code that one might add to start with.&#160; </p>  <pre class="brush: xml;">&lt;phone:PhoneApplicationPage.ApplicationBar&gt;      &lt;shell:ApplicationBar IsVisible=&quot;True&quot; IsMenuEnabled=&quot;True&quot;&gt;          &lt;shell:ApplicationBarIconButton x:Name=&quot;appbar_button1&quot; IconUri=&quot;/icons/appbar.questionmark.rest.png&quot; Text=&quot;About&quot;&gt;              &lt;i:Interaction.Triggers&gt;                  &lt;i:EventTrigger EventName=&quot;Click&quot;&gt;                      &lt;GalaSoft_MvvmLight_Command:EventToCommand Command=&quot;{Binding DisplayAbout Mode=OneWay}&quot; /&gt;                  &lt;/i:EventTrigger&gt;              &lt;/i:Interaction.Triggers&gt;            &lt;/shell:ApplicationBarIconButton&gt;          &lt;shell:ApplicationBar.MenuItems&gt;              &lt;shell:ApplicationBarMenuItem x:Name=&quot;menuItem1&quot; Text=&quot;MenuItem 1&quot;&gt;&lt;/shell:ApplicationBarMenuItem&gt;              &lt;shell:ApplicationBarMenuItem x:Name=&quot;menuItem2&quot; Text=&quot;MenuItem 2&quot;&gt;&lt;/shell:ApplicationBarMenuItem&gt;          &lt;/shell:ApplicationBar.MenuItems&gt;      &lt;/shell:ApplicationBar&gt;  &lt;/phone:PhoneApplicationPage.ApplicationBar&gt;</pre>    <p>Everything <em>looks</em> right. But we quickly notice that we have a squiggly line under our Interaction.Triggers. The problem is that the object is not a FrameworkObject. This same code <em>would</em> have worked perfect if this were a normal button. </p>    <p><a href="http://michaelcrump.net/files/image_634591065325654515.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591065353266869.png" width="580" height="402" /></a></p>    <p>OK. Point has been proved. Let’s make the ApplicationBar support Commands. So go ahead and create a new project using MVVM Light. If you want to check out the source and work along side this tutorial then click <a href="http://michaelcrump.info/2011/src/BindableAppBar.zip" target="_blank">here</a>.&#160; </p>    <p>7 Easy Steps to have binding on the Application Bar using MVVM Light (I might add that you don’t have to use MVVM Light to get this functionality I just prefer it.) </p>    <p><a href="http://michaelcrump.net/files/image_634591065361534975.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591065370271087.png" width="240" height="125" /></a></p>    <p><strong>1)</strong> Download MVVM Light if you don’t already have it and install the project templates. It is available at <a href="http://mvvmlight.codeplex.com/">http://mvvmlight.codeplex.com/</a>.</p>    <p><strong>2)</strong> Click File-New Project and navigate to Silverlight for Windows Phone. Make sure you use the MVVM Light (WP7) Template.</p>    <p><a href="http://michaelcrump.net/files/SNAGHTML1683fc7d_634591065401003481.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML1683fc7d" border="0" alt="SNAGHTML1683fc7d" src="http://michaelcrump.net/files/SNAGHTML1683fc7d_thumb_634591065438131957.png" width="748" height="456" /></a></p>    <p><strong>3)</strong> Now that we have our project setup and ready to go let’s download a wrapper created by Nicolas Humann <a href="http://www.humann.info/files/Phone7.Fx.Preview.zip">here</a> it is called <a href="http://blog.humann.info/post/2010/08/27/How-to-have-binding-on-the-ApplicationBar.aspx">Phone7.Fx</a>. After you download it then extract it somewhere that you can find it. This wrapper will make our application bar/menu item bindable. </p>    <p><strong>4)</strong> Right click References inside your WP7 project and add the .dll file to your project. </p>    <p><a href="http://michaelcrump.net/files/image_634591065442344011.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591065449520103.png" width="285" height="104" /></a></p>    <p><a href="http://michaelcrump.net/files/image_634591065455760183.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591065474324421.png" width="284" height="407" /></a></p>    <p><strong>5)</strong> In your MainPage.xaml you will need to add the proper namespace to it. Don’t forget to build your project afterwards. </p>    <pre class="brush: xml;">xmlns:Preview=&quot;clr-namespace:Phone7.Fx.Preview;assembly=Phone7.Fx.Preview&quot; </pre>    <p><strong>6)</strong> Now you can add the BindableAppBar to your MainPage.xaml with a few lines of code.&#160; </p>    <pre class="brush: xml;">&lt;Preview:BindableApplicationBar x:Name=&quot;AppBar&quot; BarOpacity=&quot;1.0&quot;  &gt;      &lt;Preview:BindableApplicationBarIconButton Command=&quot;{Binding DisplayAbout}&quot; IconUri=&quot;/icons/appbar.questionmark.rest.png&quot; Text=&quot;About&quot; /&gt;      &lt;Preview:BindableApplicationBar.MenuItems&gt;          &lt;Preview:BindableApplicationBarMenuItem  Text=&quot;Settings&quot; Command=&quot;{Binding InputBox}&quot; /&gt;      &lt;/Preview:BindableApplicationBar.MenuItems&gt;  &lt;/Preview:BindableApplicationBar&gt;</pre>  So your final MainPage.xaml will look similar to this: <strong>NOTE</strong>: The AppBar will be located inside of the Grid using this wrapper.&#160;&#160; <pre class="brush: xml;">&lt;!--LayoutRoot contains the root grid where all other page content is placed--&gt;  &lt;Grid x:Name=&quot;LayoutRoot&quot;        Background=&quot;Transparent&quot;&gt;      &lt;Grid.RowDefinitions&gt;          &lt;RowDefinition Height=&quot;Auto&quot; /&gt;          &lt;RowDefinition Height=&quot;*&quot; /&gt;      &lt;/Grid.RowDefinitions&gt;        &lt;!--TitlePanel contains the name of the application and page title--&gt;      &lt;StackPanel x:Name=&quot;TitlePanel&quot;                  Grid.Row=&quot;0&quot;                  Margin=&quot;2424012&quot;&gt;          &lt;TextBlock x:Name=&quot;ApplicationTitle&quot;                     Text=&quot;{Binding ApplicationTitle}&quot;                     Style=&quot;{StaticResource PhoneTextNormalStyle}&quot; /&gt;          &lt;TextBlock x:Name=&quot;PageTitle&quot;                     Text=&quot;{Binding PageName}&quot;                     Margin=&quot;-3-800&quot;                     Style=&quot;{StaticResource PhoneTextTitle1Style}&quot; /&gt;      &lt;/StackPanel&gt;        &lt;!--ContentPanel - place additional content here--&gt;      &lt;Grid x:Name=&quot;ContentGrid&quot;            Grid.Row=&quot;1&quot;&gt;            &lt;TextBlock Text=&quot;{Binding Welcome}&quot;                     Style=&quot;{StaticResource PhoneTextNormalStyle}&quot;                     HorizontalAlignment=&quot;Center&quot;                     VerticalAlignment=&quot;Center&quot;                     FontSize=&quot;40&quot; /&gt;        &lt;/Grid&gt;      &lt;Preview:Bind
