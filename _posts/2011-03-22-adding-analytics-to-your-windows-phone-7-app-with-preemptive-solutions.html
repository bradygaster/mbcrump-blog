---
layout: post
title: Adding Analytics to your Windows Phone 7 App with Preemptive Solutions
excerpt: 
tags: 
comments: true
---

<p>I have always been interested in learning which features of my application users are using as well as <em>if</em> they are using it.&#160; I have done this with other applications by using my own “home-grown” version of web services etc. Since I have been working a lot with Windows Phone 7 lately I decided to learn how to do this and share with the community. Before you get started you will be pleased to know that you won’t have to spend any money *at least until 2012* to do this with your existing phone apps. </p>  <p>To get started:&#160; </p>  <p>Download <strong>Dotfuscator</strong> at <a title="http://www.preemptive.com/windowsphone7.html" href="http://www.preemptive.com/windowsphone7.html">http://www.preemptive.com/windowsphone7.html</a>. After it is downloaded you will want to add your WP7 .XAP file to Dotfuscator. This will allow you to setup analytics and obfuscation of your application. </p>  <p><a href="http://michaelcrump.net/files/image_634591060684439013.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634591060701911237.png" width="508" height="443" /></a></p>  <p>After it is loaded then you will want to click on the Input tab and take a look at the .DLL’s referenced in your project.&#160; You will want to exclude any third party dll’s from the package. Don’t worry as they are not excluded entirely. The only thing you want left in here is your main application .dll and the Package Artifacts. So in the example below I removed the Telerik 3rd party controls and only left my michaelcrump.net.dll and Package Artifacts. </p>  <p><a href="http://michaelcrump.net/files/image1_634591060715015405.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image1_thumb_634591060741223741.png" width="814" height="524" /></a></p>  <p>You will now want to click on Settings and look for Instrumentation. Make sure that the first three are set to Yes.&#160; </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML11e103b_634591060757135945.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML11e103b" border="0" alt="SNAGHTML11e103b" src="http://michaelcrump.net/files/SNAGHTML11e103b_thumb_634591060790988379.png" width="814" height="655" /></a></p>  <p>Now we are going to click on the Instrumentation Tab and right click our main application .dll and add an attribute.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTML11f99b5_634591060810488629.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML11f99b5" border="0" alt="SNAGHTML11f99b5" src="http://michaelcrump.net/files/SNAGHTML11f99b5_thumb_634591060839817005.png" width="620" height="500" /></a></p>  <p>Select “PreEmptive.Attributes.Application.Attribute”.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTMLeb5f820_634591060845589079.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTMLeb5f820" border="0" alt="SNAGHTMLeb5f820" src="http://michaelcrump.net/files/SNAGHTMLeb5f820_thumb_634591060855261203.png" width="358" height="234" /></a></p>  <p>You should have this screen now. This allows you to setup the Application Type and give it a name that you can see in your Preemptive Solution Dashboard. Go ahead and fill in your applications info. You can uniquely generate a GUID by clicking on the ellipse button in the right hand corner box.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTML1215fc1_634591060878037495.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML1215fc1" border="0" alt="SNAGHTML1215fc1" src="http://michaelcrump.net/files/SNAGHTML1215fc1_thumb_634591060929050149.png" width="883" height="645" /></a></p>  <p>Once that is complete you are going to want to add a BusinessAttribute. So right click again and select BusinessAttribute.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTMLeb5f820_634591060935134227.png"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTMLeb5f820" border="0" alt="SNAGHTMLeb5f820" src="http://michaelcrump.net/files/SNAGHTMLeb5f820_thumb_634591060948862403.png" width="358" height="234" /></a></p>  <p>At this point you will want to fill in your company name as well as the CompanyKey that was provided in an email from Preemptive Solutions. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML1226231_634591060969610669.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML1226231" border="0" alt="SNAGHTML1226231" src="http://michaelcrump.net/files/SNAGHTML1226231_thumb_634591061021091329.png" width="882" height="644" /></a></p>  <p>Now that we have included our Application and Business information to our project. We will need to setup our <strong>SetupAttribute</strong> and <strong>TearDown</strong> Attribute. </p>  <p>Starting with the SetupAttribute:</p>  <p>Navigate inside your Application until you get to <strong>App</strong> –&gt; Then <strong>InitializeComponent: void(). </strong>Right click on this field and add a SetupAttribute. You will want to make sure the Custom EndPoint is set to wp7data.runtimeintelligence.com/PreEmptive.Web.Services.Messaging/MessagingServiceV2.asmx. This is a selectable option so you will not have to type it. This is basically a web service that will collect data as your users click on different items in your application. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML12370e1_634591061044491629.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML12370e1" border="0" alt="SNAGHTML12370e1" src="http://michaelcrump.net/files/SNAGHTML12370e1_thumb_634591061098000315.png" width="878" height="641" /></a></p>  <p>Now the TeardownAttribute:</p>  <p>Navigate inside your Application until you get to <strong>App</strong> –&gt; Then <strong>Application_Closing event. </strong>Right click on this field and add a TearDownAttribute. You can leave all the options on this page as the default.</p>  <p><a href="http://michaelcrump.net/files/SNAGHTML1245f64_634591061119216587.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML1245f64" border="0" alt="SNAGHTML1245f64" src="http://michaelcrump.net/files/SNAGHT
