---
layout: post
title: Information on upgrading Kinect Applications to MS SDK Beta 2.
excerpt: 
tags: 
comments: true
---

<p>&#160;</p>  <h4><img src="http://www.felipevb.com/sites/default/files/images/586_kinect_sensor_front_side_angle_0.jpg" width="458" height="258" /></h4>  <p>&#160;</p>  <h4>Introduction</h4>  <p>Microsoft recently released the Kinect for Windows SDK Beta 2. It contains many enhancements and fixes that can be found <a href="http://kinectforwindows.org/">here</a>. The only problem with it is that a lot of current demo applications no longer function properly. Today I’m going to walk you through a typical scenario of upgrading a Kinect application built with Beta 1 to Beta 2. </p>  <p><em>Note: This tutorial covers WPF but you can use the same techniques for WinForms. </em></p>  <h4>1) Fix the references</h4>  <p>Let’s start with a fairly popular Kinect demo called <a href="http://michaelcrump.info/2011/src/kinectbuttonpress1.zip">Kinect User Interface</a> Demo. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML99e3ca4_634587708386520757.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML99e3ca4" border="0" alt="SNAGHTML99e3ca4" src="http://michaelcrump.net/files/SNAGHTML99e3ca4_thumb_634587708410703547.png" width="623" height="339" /></a></p>  <p>This project uses the beta 1 version of Microsoft.Research.Kinect.dll and version 1.0.0.0 of <a href="http://c4fkinect.codeplex.com/">Coding4Fun’s Kinect library</a>. </p>  <p>After you download the source code and extract the zip you will see the following references in Visual Studio 2010:</p>  <p>Pay attention to the following references as these are the .dlls that you will have to update:</p>  <ul>   <li>Coding4Fun.Kinect.Wpf </li>    <li>Microsoft.Research.Kinect </li> </ul>  <p><a href="http://michaelcrump.net/files/image_634587708418036393.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587708432234031.png" width="255" height="317" /></a></p>  <p>If you click on Coding4Fun.Kinect.Wpf file you will see the following version information (v1.0.0.0): </p>  <p><a href="http://michaelcrump.net/files/image_634587708438786787.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587708451580263.png" width="258" height="337" /></a></p>  <p>This needs to be upgraded to the Coding4Fun Kinect library built against Beta 2. So head over to <a href="http://c4fkinect.codeplex.com/">http://c4fkinect.codeplex.com/</a> and hit download and you will have the following files. </p>  <p><a href="http://michaelcrump.net/files/image_634587708457040893.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587708469678351.png" width="556" height="124" /></a></p>  <p>Go ahead and hit the delete key on your keyboard to remove the Coding4Fun.Kinect.Wpf.dll file from your project. Select “<strong>Add Reference</strong>” and navigate out to the folder where you extracted the files and select <strong>Coding4Fun.Kinect.Wpf.dll</strong>. </p>  <p><a href="http://michaelcrump.net/files/SNAGHTML4e9332a_634587708482003773.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTML4e9332a" border="0" alt="SNAGHTML4e9332a" src="http://michaelcrump.net/files/SNAGHTML4e9332a_thumb_634587708504314347.png" width="559" height="399" /></a></p>  <p>If you click on the <strong>Coding4Fun.Kinect.Wpf.dll</strong> file and check properties it should be listed at 1.1.0.0:</p>  <p><a href="http://michaelcrump.net/files/image_634587708510867103.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587708526624921.png" width="326" height="370" /></a></p>  <h4>Fix Microsoft.Research.Kinect.dll</h4>  <p>The official SDK Beta 2 released a new .dll that you will need to reference in your application. Go ahead and select <strong>Microsoft.Research.Kinect.dll</strong> in your application and hit the Delete key on your keyboard. Go ahead and select Add Reference again and select <strong>Microsoft.Research.Kinect.dll</strong> from the .NET tab. Double check and make sure the version number is <u>1.0.0.45</u> as shown below. </p>  <p><a href="http://michaelcrump.net/files/4_634587708546127171.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="4" border="0" alt="4" src="http://michaelcrump.net/files/4_thumb_634587708595116823.png" width="535" height="393" /></a></p>  <h4>References fixed – Runtime needs to be updated. </h4>  <p>So we have fixed the references in a typical Kinect application that uses Microsoft’s SDK and C4F Kinect libraries. Now we will need to update the runtime. All Beta 1 Kinect applications will instantiate the Runtime with the following code:</p>  <p><a href="http://michaelcrump.net/files/image_634587708609314461.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634587708624604225.png" width="580" height="102" /></a></p>  <p>Can you see that it is now marked with <strong>[Depreciated]</strong>? That means we need to update it before Microsoft decides to remove it from future versions of the SDK. </p>  <p>We can fix this very easily by replacing this code: </p>  <pre class="brush: csharp;">readonly Runtime _runtime = new Runtime();</pre>    <p>with</p>    <pre class="brush: csharp;">Microsoft.Research.Kinect.Nui.Runtime _nui;</pre>    <p>and adding similar code to our Loaded event as shown below</p>    <pre class="brush: csharp;">public MainWindow()  {      InitializeComponent();      Loaded += new RoutedEventHandler(MainWindow_Loaded);  }    void MainWindow_Loaded(object sender RoutedEventArgs e)  {      if (Runtime.Kinects.Count == 0)      {          txtInfo.Text = &quot;Missing Kinect&quot;;      }      else      {          _nui = Runtime.Kinects[0];          _nui.Initialize(RuntimeOptions.UseColor);            // Video Frame Ready Event can happen now!!!           //_nui.VideoFrameReady += new EventHandler&lt;ImageFrameReadyEventArgs&gt;(_nui_VideoFrameReady);          _nui.VideoStream.Open(ImageStreamType.Video 2 ImageResolution.Resolution640x480 ImageType.Color);        }  }</pre>    <p>In this sample I am testing to see if a Kinect is detected and if it is then I initialize the runtime with my first Kinect by using the Runtime.Kinects[0]. You can also specify other Kinect devices here. The rest of the code is standard code that you simply modify however you wish (ie Skeletal Depth etc) depending on what type 
