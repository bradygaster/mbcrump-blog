---
layout: post
title: Location Awareness in about 2 minutes with Windows 8–HTML
excerpt: 
tags: 
comments: true
---

<h3>Introduction</h3>  <p>I was working on a mapping application for Windows 8 – HTML using the Bing SDK and needed to pass the latitude and longitude into it. I began searching for a straightforward way to get the location and had to read through pages of documentation before finally finding it. Here it is in case you want to use it in your own apps. </p>  <h3>Default.html</h3>  <p>Just replace the &lt;body&gt; tag as shown below: </p>  <pre class="brush: xml;">&lt;body&gt;       Latitude: &lt;div id=&quot;latitude&quot;&gt;&lt;/div&gt;&lt;br /&gt;      Longitude: &lt;div id=&quot;longitude&quot;&gt;&lt;/div&gt;&lt;br /&gt;      Accuracy: &lt;div id=&quot;accuracy&quot;&gt;&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;  &lt;/body&gt;</pre>    <p>We have simply added a few divs that represent the latitude longitude and accuracy. </p>    <h3>default.js</h3>    <pre class="brush: js;">// For an introduction to the Blank template see the following documentation:  // http://go.microsoft.com/fwlink/?LinkId=232509  (function () {      &quot;use strict&quot;;        var loc;        WinJS.Binding.optimizeBindingReferences = true;        var app = WinJS.Application;      var activation = Windows.ApplicationModel.Activation;      loc = new Windows.Devices.Geolocation.Geolocator();      loc.getGeopositionAsync().then(getPositionHandler errorHandler);        function getPositionHandler(pos) {          document.getElementById('latitude').innerHTML = pos.coordinate.latitude;          document.getElementById('longitude').innerHTML = pos.coordinate.longitude;          document.getElementById('accuracy').innerHTML = pos.coordinate.accuracy;      }        function errorHandler(e) {          // TODO: Handle Error           }        app.onactivated = function (args) {          if (args.detail.kind === activation.ActivationKind.launch) {              if (args.detail.previousExecutionState !== activation.ApplicationExecutionState.terminated) {                  // TODO: This application has been newly launched. Initialize                  // your application here.              } else {                  // TODO: This application has been reactivated from suspension.                  // Restore application state here.              }              args.setPromise(WinJS.UI.processAll());          }      };        app.oncheckpoint = function (args) {          // TODO: This application is about to be suspended. Save any state          // that needs to persist across suspensions here. You might use the          // WinJS.Application.sessionState object which is automatically          // saved and restored across suspension. If you need to complete an          // asynchronous operation before your application is suspended call          // args.setPromise().      };        app.start();         })();</pre>    <p>From the default.js page you can see that we declare loc as a variable then create a new instance of Windows.Devices.Geolocation.Geolocator(). After that we make a call to getGeopositionAsync and pass it a function that will contain the position and another function that contains the error handler. The pos.coordinate.latitude longitude and accuracy are simply added to our divs on the default.html. </p>    <h3>Application Manifest</h3>    <p>The last piece is placing a checkbox in the “Location” for capabilities which is found in the package.appxmanifest as shown below:</p>    <p><a href="http://michaelcrump.net/files/image_634840827081601277.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634840827092677419.png" width="229" height="458" /></a></p>    <p>One thing to note here is that this <strong>does not</strong> require you to have a PC with various sensors like GPS. It is using Wi-Fi triangulation and IP address to determine where you are. From my test it is very accurate!!!</p>    <h3>Run it!</h3>    <p>Now when we run our application we will see the app asking permission to use our location. We should select “Allow” here. </p>    <p><a href="http://michaelcrump.net/files/image_634840827095173451.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634840827099073501.png" width="693" height="140" /></a></p>    <p>Then we will see the latitude longitude and accuracy in our Windows 8 –HTML Application. (I obfuscated my location because it was so accurate!)</p>    <p><a href="http://michaelcrump.net/files/image_634840839249757277.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634840839253969331.png" width="132" height="261" /></a></p>    <p>Of course your users may elect to turn off location at any point by using the Settings charms and toggling the Location switch as shown below: </p>    <p><a href="http://michaelcrump.net/files/image_634840842083845611.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://michaelcrump.net/files/image_thumb_634840842088837675.png" width="261" height="325" /></a></p>    <h3>Wrap-up</h3>    <p>I am having a lot of fun with location and sensors at the moment. So much fun that I plan on creating a session around it for 2013. I’m just waiting for some solid hardware to come out. I hope this helped! Thanks for reading.</p>
